<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Instinct Index - Behavioral Readiness Survey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #121423 0%, #0a0d15 100%);
            color: #f5f5f5;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            border-bottom: 2px solid #00f0ff;
        }

        h1 {
            font-size: 2.5rem;
            color: #00f0ff;
            margin-bottom: 10px;
            font-weight: 900;
        }

        .tagline {
            color: #b4b4be;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .mode-selector {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 12px 30px;
            border: 2px solid #00f0ff;
            background-color: transparent;
            color: #00f0ff;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
            position: relative;
        }

        .mode-btn:hover {
            background-color: #00f0ff;
            color: #121423;
        }

        .mode-btn.active {
            background-color: #00f0ff;
            color: #121423;
        }

        .badge {
            display: none;
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #ff0078;
            color: #f5f5f5;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 0.75rem;
            font-weight: 700;
            line-height: 24px;
            text-align: center;
            animation: pulse 2s infinite;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .survey-container {
            background-color: #1e2332;
            border: 2px solid #00f0ff;
            padding: 40px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .progress-section {
            margin-bottom: 30px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .progress-text {
            color: #b4b4be;
            font-size: 0.95rem;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #2a2f40;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00f0ff, #ff0078);
            width: 0%;
            transition: width 0.3s ease;
        }

        .dimension-header {
            background-color: #0a0d15;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-left: 4px solid #00f0ff;
            border-radius: 4px;
        }

        .dimension-name {
            color: #00f0ff;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .dimension-description {
            color: #b4b4be;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .question-text {
            color: #f5f5f5;
            font-size: 1.05rem;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap;
        }

        .likert-option {
            flex: 1;
            min-width: 60px;
            padding: 12px 8px;
            text-align: center;
            border: 2px solid #2a2f40;
            background-color: #1a1f2e;
            color: #b4b4be;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .likert-option:hover {
            border-color: #00f0ff;
            background-color: #2a2f40;
            color: #00f0ff;
        }

        .likert-option.selected {
            background-color: #00f0ff;
            color: #121423;
            border-color: #00f0ff;
        }

        .likert-label {
            display: block;
            font-size: 0.7rem;
            margin-top: 5px;
            color: #94a3b8;
        }

        .survey-buttons {
            display: flex;
            gap: 20px;
            justify-content: space-between;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn-nav, .btn-submit {
            padding: 12px 30px;
            border: 2px solid #00f0ff;
            background-color: transparent;
            color: #00f0ff;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .btn-nav:hover, .btn-nav:disabled {
            background-color: #00f0ff;
            color: #121423;
        }

        .btn-nav:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-submit {
            border-color: #ff0078;
            color: #ff0078;
        }

        .btn-submit:hover {
            background-color: #ff0078;
            color: #f5f5f5;
        }

        .results-container {
            background-color: #1e2332;
            border: 2px solid #ff0078;
            padding: 40px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .thank-you-box {
            background: linear-gradient(135deg, #00f0ff 0%, #ff0078 100%);
            padding: 40px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 40px;
            color: #121423;
        }

        .thank-you-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .score-number {
            font-size: 3rem;
            font-weight: 900;
            margin: 20px 0;
        }

        .score-label {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .readiness-classification {
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .response-info {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            font-size: 0.95rem;
        }

        .dimension-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .dimension-card {
            background-color: #1a1f2e;
            border-left: 4px solid #00f0ff;
            padding: 20px;
            border-radius: 4px;
        }

        .dimension-card.medium {
            border-left-color: #ffd700;
        }

        .dimension-card.weak {
            border-left-color: #ff4444;
        }

        .dimension-title {
            color: #00f0ff;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .dimension-card.medium .dimension-title {
            color: #ffd700;
        }

        .dimension-card.weak .dimension-title {
            color: #ff4444;
        }

        .score-text {
            color: #f5f5f5;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .score-bar {
            width: 100%;
            height: 10px;
            background-color: #2a2f40;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .score-fill {
            height: 100%;
            background-color: #00f0ff;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .dimension-card.medium .score-fill {
            background-color: #ffd700;
        }

        .dimension-card.weak .score-fill {
            background-color: #ff4444;
        }

        .dimension-recommendation {
            color: #b4b4be;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-top: 15px;
        }

        .export-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn-export {
            padding: 12px 30px;
            border: 2px solid #00f0ff;
            background-color: transparent;
            color: #00f0ff;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .btn-export:hover {
            background-color: #00f0ff;
            color: #121423;
        }

        .btn-export.primary {
            border-color: #ff0078;
            color: #ff0078;
        }

        .btn-export.primary:hover {
            background-color: #ff0078;
            color: #f5f5f5;
        }

        .admin-container {
            background-color: #1e2332;
            border: 2px solid #00f0ff;
            padding: 40px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-box {
            background-color: #1a1f2e;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
            border: 2px solid #00f0ff;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 900;
            color: #00f0ff;
            margin: 10px 0;
        }

        .stat-label {
            color: #b4b4be;
            font-size: 0.9rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background-color: #1a1f2e;
            border: 1px solid #2a2f40;
        }

        .data-table th {
            background-color: #0a0d15;
            color: #00f0ff;
            padding: 15px;
            text-align: left;
            font-weight: 700;
            border-bottom: 2px solid #00f0ff;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #2a2f40;
            color: #f5f5f5;
        }

        .data-table tr:hover {
            background-color: #2a2f40;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            background-color: #1a1f2e;
            border: 2px solid #2a2f40;
            color: #f5f5f5;
            border-radius: 4px;
            font-size: 1rem;
        }

        .input-field:focus {
            outline: none;
            border-color: #00f0ff;
        }

        .home-intro {
            text-align: center;
        }

        .home-intro h2 {
            color: #00f0ff;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .intro-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .intro-card {
            background-color: #1a1f2e;
            padding: 20px;
            border-radius: 4px;
            border-left: 4px solid #00f0ff;
        }

        .intro-number {
            font-size: 2rem;
            font-weight: 900;
            color: #00f0ff;
            margin: 10px 0;
        }

        .intro-text {
            color: #b4b4be;
            margin-top: 10px;
        }

        .dimensions-list {
            text-align: left;
            background-color: #1a1f2e;
            padding: 20px;
            border-radius: 4px;
            border-left: 4px solid #00f0ff;
        }

        .dimensions-list p {
            color: #f5f5f5;
            margin-bottom: 10px;
        }

        .dimensions-list strong {
            color: #00f0ff;
        }

        .start-button {
            margin-top: 40px;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-color: #ff0078;
            color: #ff0078;
        }

        .report-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            border: 2px solid #00f0ff;
            background-color: transparent;
            color: #00f0ff;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background-color: #00f0ff;
            color: #121423;
        }

        .report-section {
            display: none;
        }

        .report-section.active {
            display: block;
        }

        .dimension-comparison {
            background-color: #1a1f2e;
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #2a2f40;
        }

        .comparison-label {
            color: #00f0ff;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .comparison-value {
            color: #f5f5f5;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .logout-btn {
            padding: 10px 20px;
            border: 2px solid #ff4444;
            background-color: transparent;
            color: #ff4444;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
            margin-top: 15px;
            width: 100%;
        }

        .logout-btn:hover {
            background-color: #ff4444;
            color: #f5f5f5;
        }

        .strength-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 6px 6px 6px 0;
        }

        .strength-strong {
            background-color: rgba(0, 240, 255, 0.2);
            color: #00f0ff;
            border: 1px solid #00f0ff;
        }

        .strength-medium {
            background-color: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .strength-weak {
            background-color: rgba(255, 68, 68, 0.2);
            color: #ff4444;
            border: 1px solid #ff4444;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: #1e2332;
            border: 2px solid #00f0ff;
            padding: 40px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            color: #00f0ff;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: #b4b4be;
            font-size: 0.95rem;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: #b4b4be;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            background-color: #1a1f2e;
            border: 2px solid #2a2f40;
            color: #f5f5f5;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #00f0ff;
        }

        .btn-register {
            width: 100%;
            padding: 12px;
            background-color: #00f0ff;
            color: #121423;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn-register:hover {
            background-color: #00d9e8;
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.4);
        }

        .user-info-bar {
            background-color: #0a0d15;
            padding: 12px 20px;
            border-bottom: 2px solid #00f0ff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .user-name {
            color: #00f0ff;
            font-weight: 600;
        }

        .user-tenure {
            color: #b4b4be;
            font-size: 0.9rem;
        }

        @keyframes pulse {

        .strength-weak {
            background-color: rgba(255, 68, 68, 0.2);
            color: #ff4444;
            border: 1px solid #ff4444;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: #1e2332;
            border: 2px solid #00f0ff;
            padding: 40px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            color: #00f0ff;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: #b4b4be;
            font-size: 0.95rem;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: #b4b4be;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            background-color: #1a1f2e;
            border: 2px solid #2a2f40;
            color: #f5f5f5;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #00f0ff;
        }

        .btn-register {
            width: 100%;
            padding: 12px;
            background-color: #00f0ff;
            color: #121423;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn-register:hover {
            background-color: #00d9e8;
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.4);
        }

        .user-info-bar {
            background-color: #0a0d15;
            padding: 12px 20px;
            border-bottom: 2px solid #00f0ff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .user-name {
            color: #00f0ff;
            font-weight: 600;
        }

        .user-tenure {
            color: #b4b4be;
            font-size: 0.9rem;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.15);
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .survey-container, .results-container, .admin-container {
                padding: 20px;
            }

            .likert-option {
                min-width: 50px;
                padding: 8px 4px;
                font-size: 0.75rem;
            }

            .likert-label {
                font-size: 0.6rem;
            }

            .dimension-results {
                grid-template-columns: 1fr;
            }

            .admin-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .export-buttons {
                flex-direction: column;
            }

            .btn-export {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß† AI Instinct Index</h1>
            <p class="tagline">Measure Your Organization's AI Adoption Behavioral Readiness</p>
            <p style="color: #94a3b8; font-size: 0.95rem;">68 Questions | 11 Behavioral Dimensions | 15-20 Minutes</p>
        </header>

        <div class="mode-selector">
            <button class="mode-btn active" data-mode="home" onclick="app.switchMode(event)">Home</button>
            <button class="mode-btn" data-mode="survey" onclick="app.startSurvey()">
                Take Survey
                <span class="badge" id="surveyBadge">New</span>
            </button>
            <button class="mode-btn" data-mode="admin" onclick="app.switchMode(event)">
                Admin Dashboard
                <span class="badge" id="adminBadge">üìä</span>
            </button>
        </div>

        <!-- HOME SECTION -->
        <div id="home" class="section active">
            <div class="survey-container home-intro">
                <h2>Welcome to AI Instinct Index</h2>
                <p style="color: #b4b4be; font-size: 1.1rem; line-height: 1.8; margin-bottom: 30px;">
                    This comprehensive assessment measures behavioral readiness across 11 critical dimensions of AI adoption.<br>
                    Your responses will generate personalized insights and organizational benchmarks.
                </p>
                
                <div class="intro-grid">
                    <div class="intro-card">
                        <div class="intro-number">68</div>
                        <div class="intro-text">Research-Backed Questions</div>
                    </div>
                    <div class="intro-card" style="border-left-color: #ff0078;">
                        <div class="intro-number" style="color: #ff0078;">11</div>
                        <div class="intro-text">Behavioral Dimensions</div>
                    </div>
                    <div class="intro-card">
                        <div class="intro-number">15 min</div>
                        <div class="intro-text">Completion Time</div>
                    </div>
                </div>

                <h3 style="color: #00f0ff; margin-top: 40px; margin-bottom: 20px; font-size: 1.3rem;">The 11 Behavioral Dimensions</h3>
                <div class="dimensions-list">
                    <p><strong>1. Exploration (Try)</strong> - Willingness to experiment and learn</p>
                    <p><strong style="color: #ff0078;">2. Persistence (Sustain)</strong> - Resilience and follow-through</p>
                    <p><strong>3. Integration (Normalize)</strong> - Ethical and responsible use</p>
                    <p><strong style="color: #ff0078;">4. Influence (Scale)</strong> - Knowledge sharing and peer support</p>
                    <p><strong>5. Psychological Barriers</strong> - Fear, anxiety, insecurity</p>
                    <p><strong style="color: #ff0078;">6. Digital Temperament</strong> - Technology comfort</p>
                    <p><strong>7. Trust & Explainability</strong> - Confidence in AI systems</p>
                    <p><strong style="color: #ff0078;">8. Leadership & Change Management</strong> - Executive modeling</p>
                    <p><strong>9. Policy & Communication</strong> - Clear guidance and communication</p>
                    <p><strong style="color: #ff0078;">10. Benefit Realization</strong> - Visible AI impact</p>
                    <p><strong>11. Adoption Stage & Barriers</strong> - Current phase and scaling readiness</p>
                </div>

                <button class="btn-export start-button" onclick="app.startSurvey()">
                    ‚ñ∂ Start Survey Now
                </button>
                <p style="color: #94a3b8; margin-top: 20px; font-size: 0.9rem;">Click above or use the "Take Survey" button at the top to begin</p>
            </div>
        </div>

        <!-- REGISTRATION MODAL -->
        <div id="registrationModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">üìù Register</div>
                <div class="modal-subtitle">Please provide your details before starting the survey</div>
                
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" id="fullName" class="form-input" placeholder="Enter your full name" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Email ID *</label>
                    <input type="email" id="emailId" class="form-input" placeholder="Enter your email address" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Tenure at Current Role (Years) *</label>
                    <input type="number" id="tenure" class="form-input" placeholder="e.g., 2.5" min="0" step="0.5" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Total Work Experience (Years) *</label>
                    <input type="number" id="totalExperience" class="form-input" placeholder="e.g., 8" min="0" step="0.5" required>
                </div>

                <button class="btn-register" onclick="app.submitRegistration()">Start Survey ‚Üí</button>
            </div>
        </div>

        <!-- SURVEY SECTION -->
        <div id="survey" class="section">
            <div class="survey-container">
                <div id="userInfoBar" style="display: none;">
                    <div class="user-name" id="userNameDisplay"></div>
                    <div class="user-tenure" id="userDetailsDisplay"></div>
                </div>
                <div class="progress-section">
                    <div class="progress-header">
                        <span class="progress-text" id="progressText">Question 1 of 68</span>
                        <span class="progress-text" id="currentDimension"></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                <div id="surveyContent"></div>
                <div class="survey-buttons">
                    <button class="btn-nav" onclick="app.previousQuestion()" id="btnPrev" style="display: none;">‚Üê Previous</button>
                    <button class="btn-nav" onclick="app.nextQuestion()" id="btnNext" style="display: none;">Next ‚Üí</button>
                    <button class="btn-submit" onclick="app.submitSurvey()" id="btnSubmit" style="display: none;">Submit Survey ‚úì</button>
                </div>
            </div>
        </div>

        <!-- RESULTS SECTION -->
        <div id="results" class="section">
            <div class="results-container" id="resultsContent"></div>
        </div>

        <!-- ADMIN SECTION -->
        <div id="admin" class="section">
            <div class="admin-container">
                <h2 style="color: #00f0ff; margin-bottom: 30px; font-size: 2rem;">Admin Dashboard</h2>
                
                <div id="adminLoginForm">
                    <label for="adminPassword" style="color: #b4b4be;">Admin Password:</label>
                    <input type="password" id="adminPassword" class="input-field" placeholder="Enter admin password">
                    <label for="sheetsUrl" style="color: #b4b4be; display: block; margin-top: 15px;">Google Sheets Integration URL:</label>
                    <input type="text" id="sheetsUrl" class="input-field" placeholder="https://script.google.com/macros/d/YOUR_SCRIPT_ID/usercallback" value="https://script.google.com/macros/s/AKfycbxI6UyeeR3ruVxK6JrkNu2cd_e4jmB2ZUXAeB1b5FztBnuYfErHik0ZHsJad8r7OwA-cA/exec">
                    <button class="btn-nav" onclick="app.unlockAdmin()" style="width: 100%; margin-top: 10px;">Unlock Dashboard</button>
                </div>

                <div id="adminContent" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h3 style="color: #00f0ff;">Dashboard</h3>
                        <button class="logout-btn" onclick="app.logoutAdmin()">üö™ Logout</button>
                    </div>

                    <div class="admin-grid">
                        <div class="stat-box">
                            <div style="color: #00f0ff; font-weight: 700;">Total Responses</div>
                            <div class="stat-number" id="totalResponses">0</div>
                        </div>
                        <div class="stat-box">
                            <div style="color: #ff0078; font-weight: 700;">Avg. Overall Score</div>
                            <div class="stat-number" id="avgScore">0</div>
                        </div>
                        <div class="stat-box">
                            <div style="color: #00f0ff; font-weight: 700;">Completion Rate</div>
                            <div class="stat-number" id="completionRate">0%</div>
                        </div>
                    </div>

                    <div class="report-tabs">
                        <button class="tab-btn active" onclick="app.switchReportTab('individual', this)">üìä Individual Reports</button>
                        <button class="tab-btn" onclick="app.switchReportTab('group', this)">üë• Group Report</button>
                    </div>

                    <div id="individual" class="report-section active">
                        <h3 style="color: #00f0ff; margin-bottom: 20px;">Individual Response Reports</h3>
                        <div style="overflow-x: auto;">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Response ID</th>
                                        <th>Name</th>
                                        <th>Overall Score</th>
                                        <th>Readiness Level</th>
                                        <th>Timestamp</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="group" class="report-section">
                        <h3 style="color: #00f0ff; margin-bottom: 20px;">Group Performance Analysis</h3>
                        <div id="groupReportContent"></div>
                    </div>

                    <div class="export-buttons">
                        <button class="btn-export" onclick="app.syncToGoogleSheets()">‚òÅÔ∏è Sync to Google Sheets</button>
                        <button class="btn-export" onclick="app.exportDataAsCSV()">üìä Export as CSV</button>
                        <button class="btn-export" onclick="app.exportGroupReport()">üìà Export Group Report</button>
                        <button class="btn-export" onclick="app.resetSurvey()" style="border-color: #ffd700; color: #ffd700;">üîÑ Reset Survey</button>
                        <button class="btn-export" onclick="app.clearAllData()" style="border-color: #ff4444; color: #ff4444;">üóëÔ∏è Clear All Data</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ADMIN_PASSWORD = 'admin123';
        const DEFAULT_WEBHOOK = 'https://script.google.com/macros/s/AKfycbxI6UyeeR3ruVxK6JrkNu2cd_e4jmB2ZUXAeB1b5FztBnuYfErHik0ZHsJad8r7OwA-cA/exec';

        const surveyQuestions = [
            {
                dimension: "1. EXPLORATION (Try)",
                description: "Willingness to experiment and learn",
                questions: [
                    "I actively seek out new technology tools and experiment with them in my work.",
                    "I volunteer for pilot programs or testing of new AI tools without being mandated.",
                    "When a new AI tool or feature becomes available, I am curious and willing to try it quickly.",
                    "I am comfortable learning new AI tools even if I do not receive detailed step-by-step instructions.",
                    "I frequently participate in optional AI or technology training offered by my organization.",
                    "I prefer to update my ways of working when new AI-based methods are available, rather than stick to traditional methods."
                ]
            },
            {
                dimension: "2. PERSISTENCE (Sustain)",
                description: "Resilience and follow-through",
                questions: [
                    "I usually complete AI-related training programs once I start them.",
                    "When I face errors or difficulties with an AI tool, I persist until I figure out how to overcome them.",
                    "I am willing to try an AI tool again even if my first experience with it was frustrating.",
                    "My use of AI tools remains consistent beyond the first few weeks of introduction.",
                    "I continue to explore new features and capabilities of AI tools after initial deployment.",
                    "I see challenges with AI tools as opportunities to build my skills, not reasons to give up."
                ]
            },
            {
                dimension: "3. INTEGRATION (Normalize)",
                description: "Ethical and responsible use",
                questions: [
                    "I consciously think about ethical implications when using AI in my work.",
                    "I follow my organization's data governance and privacy policies when using AI tools.",
                    "I consider the wider impact on colleagues, customers, or stakeholders before automating a task with AI.",
                    "I avoid bypassing rules or governance processes just to get faster results with AI.",
                    "I find my organization's AI policies clear and easy to follow in day-to-day work.",
                    "I receive enough guidance or training on how to use AI responsibly in my role."
                ]
            },
            {
                dimension: "4. INFLUENCE (Scale)",
                description: "Knowledge sharing and peer support",
                questions: [
                    "I have helped colleagues learn how to use AI tools.",
                    "My peers often approach me with questions about how to use AI in their work.",
                    "There are active internal groups, channels, or communities where people share AI use cases in my organization.",
                    "Successful AI use cases from one team are regularly shared with other teams.",
                    "There are visible internal champions who advocate for AI adoption in my organization.",
                    "I actively encourage others to experiment with AI tools and share my experiences."
                ]
            },
            {
                dimension: "5. PSYCHOLOGICAL BARRIERS",
                description: "Fear, anxiety, insecurity",
                questions: [
                    "I rarely worry that AI will replace my job in the near future.",
                    "AI tools have not significantly increased my stress or anxiety at work.",
                    "I am comfortable using AI for core, important tasks in my role.",
                    "I do not feel that using AI makes me look lazy or less hardworking.",
                    "I do not worry that relying on AI will make others see me as a fraud or less capable.",
                    "I feel confident that if AI makes a mistake, it does not automatically make me look incompetent."
                ]
            },
            {
                dimension: "6. DIGITAL TEMPERAMENT",
                description: "Technology comfort and ambiguity tolerance",
                questions: [
                    "I feel comfortable working with technology that is new, uncertain, or still evolving.",
                    "In the past, I have generally embraced new tools and systems introduced at work.",
                    "I can manage any anxiety I feel when learning new AI technologies.",
                    "The training and support I receive matches my level of comfort with digital tools.",
                    "I am comfortable working with AI systems that provide probabilistic or non-deterministic outputs.",
                    "I do not need technology to be perfectly predictable in order to trust and use it."
                ]
            },
            {
                dimension: "7. TRUST & EXPLAINABILITY",
                description: "Confidence in AI systems",
                questions: [
                    "I have a basic understanding of how the AI tools I use arrive at their outputs or recommendations.",
                    "My organization communicates clearly about the limitations and possible errors of AI systems.",
                    "When I see an AI system make a mistake, I still remain open to using it with proper safeguards.",
                    "I trust AI tools to support important decisions in my work, with appropriate human oversight.",
                    "I can access performance metrics or feedback that show how well AI tools are working over time.",
                    "I am willing to use AI not just for simple factual lookups, but also for more strategic or complex tasks when appropriate."
                ]
            },
            {
                dimension: "8. LEADERSHIP & CHANGE MANAGEMENT",
                description: "Executive modeling and support",
                questions: [
                    "Senior leaders in my organization visibly use AI tools in their own work.",
                    "What leaders say about AI strategy matches what I experience in my daily work.",
                    "Leaders openly talk about their own learning journey with AI, including their challenges.",
                    "AI initiatives are clearly championed by the C-suite or top management.",
                    "There is a structured change management plan to support AI adoption in my organization.",
                    "Employees are encouraged to experiment with AI and learn from mistakes, not just to comply with rules.",
                    "Leaders are honest about what they know and don't know regarding AI."
                ]
            },
            {
                dimension: "9. POLICY & COMMUNICATION",
                description: "Clear guidance and communication",
                questions: [
                    "My organization has a simple, accessible AI policy or AI charter that I can easily find.",
                    "There are clear incentives or recognition for teams that successfully adopt AI.",
                    "I know which specific AI tools or platforms are officially approved for me to use.",
                    "AI-related policies and guidelines are communicated consistently across all levels of the organization.",
                    "The messages I receive about AI do not conflict or send mixed signals.",
                    "There is good alignment between what leadership says about AI and what actually happens in practice."
                ]
            },
            {
                dimension: "10. BENEFIT REALIZATION",
                description: "Visible AI impact",
                questions: [
                    "AI benefits are explained to me in concrete, task-specific terms, such as time saved on a particular task.",
                    "I can name specific examples where AI has improved speed or quality in my own work.",
                    "My organization shares internal success stories of AI with clear numbers or impact metrics.",
                    "Time or effort saved through AI is measured and recognized in my team or organization.",
                    "I clearly notice the benefits of AI in my daily work rather than feeling its impact is vague or invisible."
                ]
            },
            {
                dimension: "11. ADOPTION STAGE & BARRIERS",
                description: "Current phase and scaling readiness",
                questions: [
                    "In my team, people are generally motivated to try new AI tools.",
                    "There is not a lot of bureaucratic friction that stops us from using AI.",
                    "AI is viewed as a way to reduce or replace low-value work, not as an extra burden on top of existing tasks.",
                    "AI is embedded into our regular workflows rather than used only in one-off or ad hoc ways.",
                    "We can see clear, measurable improvements from our use of AI in speed, quality, or cost.",
                    "In my organization, AI is already being used for complex, high-value decisions, not just simple or low-risk tasks.",
                    "Our AI pilots usually move forward into scaled deployment rather than stalling at experiment stage.",
                    "Over the past year, overall AI usage in my organization has deepened rather than plateaued or declined."
                ]
            }
        ];

        const app = {
            currentQuestion: 0,
            responses: [],
            allResponses: [],
            currentReportTab: 'individual',
            isAdminLoggedIn: false,
            currentRegistration: null,

            init() {
                this.loadResponses();
                this.loadRegistrations();
                this.updateBadges();
            },

            loadRegistrations() {
                try {
                    const stored = localStorage.getItem('aiSurveyRegistrations');
                    this.allRegistrations = stored ? JSON.parse(stored) : [];
                } catch (e) {
                    this.allRegistrations = [];
                }
            },

            saveRegistrations() {
                try {
                    localStorage.setItem('aiSurveyRegistrations', JSON.stringify(this.allRegistrations));
                } catch (e) {
                    console.log('Unable to save registrations');
                }
            },

            updateBadges() {
                const surveyBadge = document.getElementById('surveyBadge');
                const adminBadge = document.getElementById('adminBadge');

                if (this.allResponses.length === 0) {
                    surveyBadge.style.display = 'inline-block';
                } else {
                    surveyBadge.style.display = 'none';
                }

                if (this.allResponses.length > 0) {
                    adminBadge.style.display = 'inline-block';
                } else {
                    adminBadge.style.display = 'none';
                }
            },

            loadResponses() {
                try {
                    const stored = localStorage.getItem('aiSurveyResponses');
                    this.allResponses = stored ? JSON.parse(stored) : [];
                } catch (e) {
                    this.allResponses = [];
                }
            },

            saveResponses() {
                try {
                    localStorage.setItem('aiSurveyResponses', JSON.stringify(this.allResponses));
                } catch (e) {
                    console.log('Unable to save responses');
                }
            },

            switchMode(event) {
                event.preventDefault();
                const mode = event.target.getAttribute('data-mode');

                document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');

                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(mode).classList.add('active');

                if (mode === 'admin' && this.isAdminLoggedIn) {
                    this.refreshAdminDashboard();
                }
            },

            getTotalQuestions() {
                return surveyQuestions.reduce((sum, dim) => sum + dim.questions.length, 0);
            },

            startSurvey() {
                document.getElementById('registrationModal').classList.add('active');
            },

            submitRegistration() {
                const fullName = document.getElementById('fullName').value.trim();
                const emailId = document.getElementById('emailId').value.trim();
                const tenure = parseFloat(document.getElementById('tenure').value);
                const totalExperience = parseFloat(document.getElementById('totalExperience').value);

                if (!fullName || !emailId || isNaN(tenure) || isNaN(totalExperience)) {
                    alert('Please fill in all required fields');
                    return;
                }

                if (!emailId.includes('@')) {
                    alert('Please enter a valid email address');
                    return;
                }

                this.currentRegistration = {
                    fullName,
                    emailId,
                    tenure,
                    totalExperience,
                    timestamp: new Date().toLocaleString()
                };

                this.sendRegistrationToSheets();

                document.getElementById('registrationModal').classList.remove('active');

                this.responses = new Array(this.getTotalQuestions()).fill(undefined);
                this.currentQuestion = 0;

                document.querySelectorAll('.mode-btn').forEach((btn, idx) => {
                    if (idx === 1) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById('survey').classList.add('active');

                document.getElementById('userInfoBar').style.display = 'flex';
                document.getElementById('userNameDisplay').textContent = `üë§ ${fullName}`;
                document.getElementById('userDetailsDisplay').textContent = `Tenure: ${tenure} yrs | Total Experience: ${totalExperience} yrs`;

                setTimeout(() => {
                    this.renderQuestion();
                    window.scrollTo(0, 0);
                }, 50);
            },

            sendRegistrationToSheets() {
                const sheetsUrl = document.getElementById('sheetsUrl').value;
                if (!sheetsUrl) {
                    console.log('Google Sheets URL not configured.');
                    return;
                }

                const payload = {
                    type: 'registration',
                    fullName: this.currentRegistration.fullName,
                    emailId: this.currentRegistration.emailId,
                    tenure: this.currentRegistration.tenure,
                    totalExperience: this.currentRegistration.totalExperience,
                    timestamp: this.currentRegistration.timestamp
                };

                this.syncWithRetry(sheetsUrl, payload, 'registration');
            },

            syncWithRetry(sheetsUrl, payload, type, attempt = 1) {
                const maxAttempts = 3;
                fetch(sheetsUrl, {
                    method: 'POST',
                    body: JSON.stringify(payload),
                    mode: 'no-cors'
                }).then(() => {
                    console.log(`‚úì ${type} data synced to Google Sheets (attempt ${attempt})`);
                }).catch(e => {
                    if (attempt < maxAttempts) {
                        console.log(`Retry attempt ${attempt + 1} for ${type}...`);
                        setTimeout(() => {
                            this.syncWithRetry(sheetsUrl, payload, type, attempt + 1);
                        }, 1000 * attempt);
                    } else {
                        console.log(`‚úó Sheets sync failed after ${maxAttempts} attempts:`, e);
                    }
                });
            },

            getCurrentDimension() {
                let qIndex = 0;
                for (let i = 0; i < surveyQuestions.length; i++) {
                    const qCount = surveyQuestions[i].questions.length;
                    if (this.currentQuestion >= qIndex && this.currentQuestion < qIndex + qCount) {
                        return { dimIndex: i, qIndex: this.currentQuestion - qIndex };
                    }
                    qIndex += qCount;
                }
                return { dimIndex: 0, qIndex: 0 };
            },

            renderQuestion() {
                const { dimIndex, qIndex } = this.getCurrentDimension();
                const dim = surveyQuestions[dimIndex];
                const q = dim.questions[qIndex];
                const total = this.getTotalQuestions();
                const progress = ((this.currentQuestion + 1) / total) * 100;

                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('progressText').textContent = `Question ${this.currentQuestion + 1} of ${total}`;
                document.getElementById('currentDimension').textContent = dim.dimension;

                let html = `
                    <div class="dimension-header">
                        <div class="dimension-name">${dim.dimension}</div>
                        <div class="dimension-description">${dim.description}</div>
                    </div>
                    <div class="question-text">${q}</div>
                    <div class="likert-scale">
                        <div class="likert-option" onclick="app.selectAnswer(1)">
                            <span>1</span>
                            <span class="likert-label">Strongly Disagree</span>
                        </div>
                        <div class="likert-option" onclick="app.selectAnswer(2)">
                            <span>2</span>
                            <span class="likert-label">Disagree</span>
                        </div>
                        <div class="likert-option" onclick="app.selectAnswer(3)">
                            <span>3</span>
                            <span class="likert-label">Neutral</span>
                        </div>
                        <div class="likert-option" onclick="app.selectAnswer(4)">
                            <span>4</span>
                            <span class="likert-label">Agree</span>
                        </div>
                        <div class="likert-option" onclick="app.selectAnswer(5)">
                            <span>5</span>
                            <span class="likert-label">Strongly Agree</span>
                        </div>
                    </div>
                `;

                document.getElementById('surveyContent').innerHTML = html;

                setTimeout(() => {
                    if (this.responses[this.currentQuestion] !== undefined) {
                        const options = document.querySelectorAll('.likert-option');
                        options[this.responses[this.currentQuestion] - 1].classList.add('selected');
                    }
                }, 50);

                document.getElementById('btnPrev').style.display = this.currentQuestion > 0 ? 'inline-block' : 'none';
                document.getElementById('btnNext').style.display = this.currentQuestion < total - 1 ? 'inline-block' : 'none';
                document.getElementById('btnSubmit').style.display = this.currentQuestion === total - 1 ? 'inline-block' : 'none';
            },

            selectAnswer(value) {
                this.responses[this.currentQuestion] = value;
                document.querySelectorAll('.likert-option').forEach(opt => opt.classList.remove('selected'));
                document.querySelectorAll('.likert-option')[value - 1].classList.add('selected');
            },

            nextQuestion() {
                if (this.responses[this.currentQuestion] === undefined) {
                    alert('Please select an answer before proceeding');
                    return;
                }
                this.currentQuestion++;
                setTimeout(() => {
                    this.renderQuestion();
                    window.scrollTo(0, 0);
                }, 50);
            },

            previousQuestion() {
                if (this.currentQuestion > 0) {
                    this.currentQuestion--;
                    setTimeout(() => {
                        this.renderQuestion();
                        window.scrollTo(0, 0);
                    }, 50);
                }
            },

            submitSurvey() {
                const unanswered = this.responses.filter(r => r === undefined).length;
                if (unanswered > 0) {
                    alert(`Please complete all questions. Unanswered: ${unanswered}`);
                    return;
                }

                const results = this.calculateResults();
                const response = {
                    id: 'RESP-' + Date.now(),
                    responses: [...this.responses],
                    results: results,
                    timestamp: new Date().toLocaleString(),
                    registration: this.currentRegistration
                };

                this.allResponses.push(response);
                this.saveResponses();
                this.updateBadges();
                this.sendToGoogleSheets(response);
                this.displayResults(results, response);

                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById('results').classList.add('active');
                window.scrollTo(0, 0);
            },

            sendToGoogleSheets(response) {
                const sheetsUrl = document.getElementById('sheetsUrl').value;
                if (!sheetsUrl) {
                    console.log('Google Sheets URL not configured.');
                    return;
                }

                const payload = {
                    type: 'survey',
                    responseId: response.id,
                    fullName: response.registration.fullName,
                    emailId: response.registration.emailId,
                    tenure: response.registration.tenure,
                    totalExperience: response.registration.totalExperience,
                    overallScore: response.results.overallScore,
                    readinessLevel: response.results.readinessLevel,
                    timestamp: response.timestamp,
                    dimensionScores: response.results.dimensionScores,
                    allResponses: response.responses
                };

                this.syncWithRetry(sheetsUrl, payload, 'survey response');
            },

            calculateResults() {
                const dimensionScores = [];
                let qIndex = 0;

                for (let dim = 0; dim < surveyQuestions.length; dim++) {
                    const qCount = surveyQuestions[dim].questions.length;
                    let sum = 0;

                    for (let q = 0; q < qCount; q++) {
                        sum += this.responses[qIndex];
                        qIndex++;
                    }

                    const avg = sum / qCount;
                    const score = Math.round(avg * 20);

                    dimensionScores.push({
                        name: surveyQuestions[dim].dimension,
                        score: score
                    });
                }

                const overallScore = Math.round(dimensionScores.reduce((sum, d) => sum + d.score, 0) / 11);
                const readinessLevel = overallScore >= 75 ? 'Strong' : (overallScore >= 50 ? 'Moderate' : 'Weak');

                return {
                    overallScore,
                    readinessLevel,
                    dimensionScores
                };
            },

            displayResults(results, response) {
                const recommendations = {
                    "Strong": "Your organization demonstrates strong behavioral readiness for AI adoption. Focus on scaling and expanding AI initiatives across more complex use cases.",
                    "Moderate": "Your organization has foundational readiness but needs targeted interventions. Address the lowest-scoring dimensions to unlock full potential.",
                    "Weak": "Significant behavioral gaps require foundational change management. Start with psychological safety, leadership alignment, and clear communication."
                };

                const dimRecommendations = {
                    "1. EXPLORATION (Try)": "Encourage experimentation through low-risk pilot programs and internal innovation challenges.",
                    "2. PERSISTENCE (Sustain)": "Build resilience through peer mentoring and celebrating learning from failures.",
                    "3. INTEGRATION (Normalize)": "Create clear ethical guidelines and governance frameworks for responsible AI use.",
                    "4. INFLUENCE (Scale)": "Establish communities of practice and internal AI champions for knowledge sharing.",
                    "5. PSYCHOLOGICAL BARRIERS": "Address fears through psychological safety programs and transparent communication.",
                    "6. DIGITAL TEMPERAMENT": "Offer tailored training programs matched to individual comfort levels with technology.",
                    "7. TRUST & EXPLAINABILITY": "Enhance AI transparency through explainability documentation and performance metrics.",
                    "8. LEADERSHIP & CHANGE MANAGEMENT": "Ensure visible executive sponsorship and consistent messaging about AI strategy.",
                    "9. POLICY & COMMUNICATION": "Create clear, accessible AI policies and consistent organizational communication.",
                    "10. BENEFIT REALIZATION": "Showcase concrete AI impact through success stories and measurable metrics.",
                    "11. ADOPTION STAGE & BARRIERS": "Scale successful pilots and address systemic barriers to adoption."
                };

                const strengths = results.dimensionScores.filter(d => d.score >= 75).map(d => d.name);
                const weakAreas = results.dimensionScores.filter(d => d.score < 50).map(d => d.name);

                let html = `
                    <div class="thank-you-box">
                        <div class="thank-you-icon">‚úÖ</div>
                        <div class="score-label">Your AI Instinct Index Score</div>
                        <div class="score-number">${results.overallScore}</div>
                        <div class="readiness-classification">${results.readinessLevel} Readiness</div>
                        <div style="margin-top: 20px; font-size: 1rem; line-height: 1.6;">${recommendations[results.readinessLevel]}</div>
                        <div class="response-info">
                            Response ID: <strong>${response.id}</strong> | Submitted: <strong>${response.timestamp}</strong>
                        </div>
                    </div>

                    <h3 style="color: #00f0ff; margin-bottom: 20px; font-size: 1.3rem;">üìä Behavioral Dimension Scores</h3>
                    <div class="dimension-results">
                `;

                results.dimensionScores.forEach(dimension => {
                    let cardClass = 'dimension-card';
                    if (dimension.score >= 75) {
                        cardClass += '';
                    } else if (dimension.score >= 50) {
                        cardClass += ' medium';
                    } else {
                        cardClass += ' weak';
                    }

                    html += `
                        <div class="${cardClass}">
                            <div class="dimension-title">${dimension.name}</div>
                            <div class="score-text">${dimension.score}/100</div>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${dimension.score}%"></div>
                            </div>
                            <div class="dimension-recommendation">${dimRecommendations[dimension.name]}</div>
                        </div>
                    `;
                });

                html += `</div>`;

                if (strengths.length > 0) {
                    html += `
                        <h3 style="color: #00f0ff; margin-top: 40px; margin-bottom: 20px; font-size: 1.3rem;">‚ú® Key Strengths</h3>
                        <div style="margin-bottom: 30px;">
                    `;
                    strengths.forEach(s => {
                        html += `<span class="strength-badge strength-strong">${s}</span>`;
                    });
                    html += `</div>`;
                }

                if (weakAreas.length > 0) {
                    html += `
                        <h3 style="color: #ff4444; margin-bottom: 20px; font-size: 1.3rem;">‚ö†Ô∏è Priority Areas for Improvement</h3>
                        <div style="margin-bottom: 30px;">
                    `;
                    weakAreas.forEach(w => {
                        html += `<span class="strength-badge strength-weak">${w}</span>`;
                    });
                    html += `</div>`;
                }

                html += `
                    <div class="export-buttons">
                        <button class="btn-export primary" onclick="app.downloadPDFReport('${response.id}')">üìÑ Download PDF Report</button>
                        <button class="btn-export" onclick="app.exportResultsAsJSON()">üì• Download Report (JSON)</button>
                        <button class="btn-export" onclick="app.printResults()">üñ®Ô∏è Print Results</button>
                        <button class="btn-export" onclick="app.restartSurvey()">üîÑ Take Survey Again</button>
                    </div>
                `;

                document.getElementById('resultsContent').innerHTML = html;
            },

            restartSurvey() {
                document.getElementById('fullName').value = '';
                document.getElementById('emailId').value = '';
                document.getElementById('tenure').value = '';
                document.getElementById('totalExperience').value = '';
                this.currentRegistration = null;
                this.startSurvey();
            },

            waitForJsPDF(maxAttempts = 6, attempt = 0) {
                return new Promise((resolve, reject) => {
                    if (window.jspdf && window.jspdf.jsPDF) {
                        console.log('‚úì jsPDF library loaded successfully');
                        resolve();
                        return;
                    }
                    
                    if (attempt >= maxAttempts) {
                        console.error('‚úó jsPDF library timeout after ' + (attempt * 500) + 'ms');
                        reject(new Error('jsPDF library timeout'));
                        return;
                    }
                    
                    console.log(`Waiting for jsPDF library... (attempt ${attempt + 1}/${maxAttempts})`);
                    setTimeout(() => {
                        this.waitForJsPDF(maxAttempts, attempt + 1).then(resolve).catch(reject);
                    }, 500);
                });
            },

            downloadPDFReport(responseId) {
                const response = this.allResponses.find(r => r.id === responseId);
                if (!response) {
                    alert('Response not found');
                    return;
                }

                const btn = event.target;
                btn.textContent = '‚è≥ Generating PDF...';
                btn.disabled = true;

                this.waitForJsPDF()
                    .then(() => {
                        try {
                            const { jsPDF } = window.jspdf;
                            const doc = new jsPDF();
                            const pageHeight = doc.internal.pageSize.getHeight();
                            const pageWidth = doc.internal.pageSize.getWidth();
                            let yPosition = 20;

                            // Title
                            doc.setFontSize(20);
                            doc.setTextColor(0, 240, 255);
                            doc.text('AI Instinct Index Report', 20, yPosition);

                            // Header Info
                            yPosition += 12;
                            doc.setFontSize(10);
                            doc.setTextColor(180, 180, 190);
                            doc.text(`Response ID: ${response.id}`, 20, yPosition);
                            yPosition += 7;
                            doc.text(`Name: ${response.registration.fullName}`, 20, yPosition);
                            yPosition += 7;
                            doc.text(`Email: ${response.registration.emailId}`, 20, yPosition);
                            yPosition += 7;
                            doc.text(`Tenure: ${response.registration.tenure} yrs | Experience: ${response.registration.totalExperience} yrs`, 20, yPosition);
                            yPosition += 7;
                            doc.text(`Date: ${response.timestamp}`, 20, yPosition);

                            // Overall Score
                            yPosition += 12;
                            doc.setFontSize(16);
                            doc.setTextColor(0, 240, 255);
                            doc.text(`Score: ${response.results.overallScore}/100`, 20, yPosition);

                            // Readiness Level
                            yPosition += 10;
                            doc.setFontSize(12);
                            doc.setTextColor(response.results.readinessLevel === 'Strong' ? 0 : 255, 240, 255);
                            doc.text(`Readiness: ${response.results.readinessLevel}`, 20, yPosition);

                            // Dimension Scores Section
                            yPosition += 15;
                            doc.setFontSize(12);
                            doc.setTextColor(0, 240, 255);
                            doc.text('Behavioral Dimension Scores:', 20, yPosition);

                            yPosition += 10;
                            doc.setFontSize(9);
                            doc.setTextColor(180, 180, 190);

                            response.results.dimensionScores.forEach((dimension, idx) => {
                                // Auto page break if too close to bottom
                                if (yPosition > pageHeight - 20) {
                                    doc.addPage();
                                    yPosition = 20;
                                    // Repeat header on new page
                                    doc.setFontSize(12);
                                    doc.setTextColor(0, 240, 255);
                                    doc.text('Behavioral Dimension Scores (continued):', 20, yPosition);
                                    yPosition += 10;
                                    doc.setFontSize(9);
                                    doc.setTextColor(180, 180, 190);
                                }
                                
                                const scoreText = `${idx + 1}. ${dimension.name}: ${dimension.score}/100`;
                                doc.text(scoreText, 25, yPosition);
                                yPosition += 6;
                            });

                            // Footer
                            yPosition += 10;
                            doc.setFontSize(8);
                            doc.setTextColor(100, 100, 100);
                            doc.text('This report was generated by the AI Instinct Index Assessment Tool', 20, yPosition);

                            // Save
                            doc.save(`AI-Instinct-Report-${response.id}.pdf`);
                            console.log('‚úì PDF generated successfully: ' + response.id);
                            btn.textContent = 'üìÑ Download PDF Report';
                            btn.disabled = false;
                        } catch (e) {
                            console.error('‚úó PDF generation error:', e);
                            btn.textContent = 'üìÑ Download PDF Report';
                            btn.disabled = false;
                            this.fallbackDownload(response);
                        }
                    })
                    .catch(err => {
                        console.error('‚úó Failed to load jsPDF:', err);
                        btn.textContent = 'üìÑ Download PDF Report';
                        btn.disabled = false;
                        this.fallbackDownload(response);
                    });
            },

            fallbackDownload(response) {
                const line = '='.repeat(60);
                let content = `
${line}
AI INSTINCT INDEX - PROFESSIONAL REPORT
${line}

PARTICIPANT INFORMATION
${line}
Response ID:          ${response.id}
Participant Name:     ${response.registration.fullName}
Email:                ${response.registration.emailId}
Tenure (Current Role): ${response.registration.tenure} years
Total Work Experience: ${response.registration.totalExperience} years
Assessment Date:      ${response.timestamp}

${line}
OVERALL ASSESSMENT RESULTS
${line}
AI Instinct Index Score: ${response.results.overallScore}/100
Behavioral Readiness:    ${response.results.readinessLevel}

${line}
BEHAVIORAL DIMENSION BREAKDOWN
${line}

`;

                response.results.dimensionScores.forEach((d, idx) => {
                    const barLength = Math.round(d.score / 5);
                    const bar = '‚ñà'.repeat(barLength) + '‚ñë'.repeat(20 - barLength);
                    content += `\n${idx + 1}. ${d.name}\n`;
                    content += `   Score: ${d.score}/100\n`;
                    content += `   Progress: [${bar}]\n`;
                });

                content += `\n${line}\n`;
                content += 'Generated by AI Instinct Index Assessment Tool\n';
                content += `${line}\n`;

                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `AI-Instinct-Report-${response.id}.txt`;
                link.click();
                console.log('‚úì Fallback TXT report downloaded: ' + response.id);
            },

            exportResultsAsJSON() {
                if (this.allResponses.length === 0) {
                    alert('No responses to export');
                    return;
                }

                const dataStr = JSON.stringify(this.allResponses, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'ai-instinct-results.json';
                link.click();
            },

            printResults() {
                window.print();
            },

            startNewSurvey() {
                this.currentRegistration = null;
                this.startSurvey();
            },

            unlockAdmin() {
                const password = document.getElementById('adminPassword').value;
                if (password === ADMIN_PASSWORD) {
                    this.isAdminLoggedIn = true;
                    document.getElementById('adminLoginForm').style.display = 'none';
                    document.getElementById('adminContent').style.display = 'block';
                    this.refreshAdminDashboard();
                } else {
                    alert('Incorrect password');
                    document.getElementById('adminPassword').value = '';
                }
            },

            logoutAdmin() {
                this.isAdminLoggedIn = false;
                document.getElementById('adminLoginForm').style.display = 'block';
                document.getElementById('adminContent').style.display = 'none';
                document.getElementById('adminPassword').value = '';
            },

            refreshAdminDashboard() {
                const totalResponses = this.allResponses.length;
                const avgScore = totalResponses > 0 ? Math.round(this.allResponses.reduce((sum, r) => sum + r.results.overallScore, 0) / totalResponses) : 0;

                document.getElementById('totalResponses').textContent = totalResponses;
                document.getElementById('avgScore').textContent = avgScore;
                document.getElementById('completionRate').textContent = '100%';

                this.renderIndividualReports();
                this.renderGroupReport();
            },

            renderIndividualReports() {
                let html = '';
                this.allResponses.forEach(response => {
                    const badgeClass = response.results.readinessLevel.toLowerCase() === 'strong' ? 'strong' : (response.results.readinessLevel.toLowerCase() === 'moderate' ? 'medium' : 'weak');
                    const userName = response.registration ? response.registration.fullName : 'Unknown';
                    html += `
                        <tr>
                            <td>${response.id}</td>
                            <td>${userName}</td>
                            <td><strong>${response.results.overallScore}/100</strong></td>
                            <td><span class="strength-badge strength-${badgeClass}">${response.results.readinessLevel}</span></td>
                            <td>${response.timestamp}</td>
                            <td><button class="btn-nav" onclick="app.viewDetailedReport('${response.id}')" style="padding: 6px 12px; font-size: 0.85rem;">View</button></td>
                        </tr>
                    `;
                });
                document.getElementById('tableBody').innerHTML = html || '<tr><td colspan="6" style="text-align: center; color: #b4b4be;">No responses yet</td></tr>';
            },

            renderGroupReport() {
                if (this.allResponses.length === 0) {
                    document.getElementById('groupReportContent').innerHTML = '<p style="color: #b4b4be;">No responses available for group analysis</p>';
                    return;
                }

                const dimensionAverages = {};
                surveyQuestions.forEach((dim, idx) => {
                    let totalScore = 0;
                    this.allResponses.forEach(response => {
                        totalScore += response.results.dimensionScores[idx].score;
                    });
                    dimensionAverages[dim.dimension] = Math.round(totalScore / this.allResponses.length);
                });

                let html = '<div>';
                Object.entries(dimensionAverages).forEach(([dimension, score]) => {
                    html += `
                        <div class="dimension-comparison">
                            <div class="comparison-label">${dimension}</div>
                            <div class="comparison-value">${score}/100</div>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${score}%; background-color: #00f0ff;"></div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                document.getElementById('groupReportContent').innerHTML = html;
            },

            switchReportTab(tab, btn) {
                this.currentReportTab = tab;
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                document.querySelectorAll('.report-section').forEach(s => s.classList.remove('active'));
                document.getElementById(tab).classList.add('active');
            },

            viewDetailedReport(responseId) {
                const response = this.allResponses.find(r => r.id === responseId);
                if (!response) return;
                alert(`Report: ${responseId}\n\nScore: ${response.results.overallScore}/100\nReadiness: ${response.results.readinessLevel}\n\nDownload JSON for full details.`);
            },

            syncToGoogleSheets() {
                if (this.allResponses.length === 0) {
                    alert('No responses to sync');
                    return;
                }
                
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚è≥ Syncing...';
                btn.disabled = true;

                let synced = 0;
                this.allResponses.forEach(response => {
                    this.sendToGoogleSheets(response);
                    synced++;
                });

                setTimeout(() => {
                    alert(`‚úì Synced ${synced} responses to Google Sheets. Check your sheet for data.`);
                    btn.textContent = originalText;
                    btn.disabled = false;
                    this.refreshAdminDashboard();
                }, 1500);
            },

            exportDataAsCSV() {
                if (this.allResponses.length === 0) {
                    alert('No data to export');
                    return;
                }

                let csv = 'Response ID,Overall Score,Readiness Level,Timestamp\n';
                this.allResponses.forEach(response => {
                    csv += `${response.id},${response.results.overallScore},${response.results.readinessLevel},"${response.timestamp}"\n`;
                });

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'ai-instinct-data.csv';
                link.click();
            },

            exportGroupReport() {
                if (this.allResponses.length === 0) {
                    alert('No data to export');
                    return;
                }

                const dimensionAverages = {};
                surveyQuestions.forEach((dim, idx) => {
                    let totalScore = 0;
                    this.allResponses.forEach(response => {
                        totalScore += response.results.dimensionScores[idx].score;
                    });
                    dimensionAverages[dim.dimension] = Math.round(totalScore / this.allResponses.length);
                });

                let csv = 'Dimension,Average Score\n';
                Object.entries(dimensionAverages).forEach(([dimension, score]) => {
                    csv += `"${dimension}",${score}\n`;
                });

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'ai-instinct-group-report.csv';
                link.click();
            },

            resetSurvey() {
                if (confirm('Delete ALL survey responses AND registrations? This cannot be undone.')) {
                    this.allResponses = [];
                    this.allRegistrations = [];
                    this.saveResponses();
                    this.saveRegistrations();
                    this.currentQuestion = 0;
                    this.responses = new Array(this.getTotalQuestions()).fill(undefined);
                    this.currentRegistration = null;
                    this.updateBadges();
                    this.refreshAdminDashboard();
                    alert('All survey and registration data cleared.');
                }
            },

            clearAllData() {
                if (confirm('Delete ALL response data? This cannot be undone.')) {
                    this.allResponses = [];
                    this.saveResponses();
                    this.updateBadges();
                    this.refreshAdminDashboard();
                    alert('All data cleared');
                }
            }
        };

        app.init();
    </script>
</body>
</html>
